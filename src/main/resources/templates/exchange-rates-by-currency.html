<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Currency</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

</head>
<body data-bs-theme="dark" id="body">
<div th:insert="~{base.html :: header}">
</div>

<div class="container rounded border border-2">
    <form class="form border rounded m-2 p-5 bg-light-subtle" id="exchangeRatesForm">
        <label class="form-label" for="startDate">Start Date:</label>
        <input class="form-control mb-2 bg-light-subtle" type="date" id="startDate" required>

        <label class="form-label" for="endDate">End Date:</label>
        <input class="form-control mb-2 bg-light-subtle" type="date" id="endDate" required>

        <button class="btn btn-primary"  type="button" onclick="makeRequest()">Get Exchange Rates</button>
    </form>
    <script>
        function makeRequest() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const requestURL = `/currencies/2/exchange-rates?startDate=${startDate}&endDate=${endDate}`;
            window.location.replace(requestURL);
        }
    </script>
    <table class="text-center table table-hover">
        <thead>
        <tr>
            <th> Exchange Rate</th>
            <th> Date</th>
        </tr>
        </thead>
        <tbody>
        <tr th:switch="${exchangeRates.size()}">
            <td colspan="3" th:case="0"> No Exchange Rate Available</td>
            <td colspan="3" th:case="1"> 1 Exchange Rate Available</td>
            <td colspan="3" th:case="*"><span th:text="${exchangeRates.size()}"></span> Exchange Rates Available</td>
        </tr>
        <tr th:each="exchangeRate : ${exchangeRates}">
            <td><span th:text="${exchangeRate.rate}"> rate </span></td>
            <td><span th:text="${exchangeRate.localDate}"> date </span></td>
        </tr>
        </tbody>
    </table>
    <button class="btn btn-secondary m-3"><a th:href="@{'/currencies/' +${currencyId} + '/exchange-rates/new'}"
                                             class="text-decoration-none">Add Exchange Rate</a>
    </button>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>
</html>